"use strict";function validate(){var e=document.getElementById("tag").value,o=document.getElementById("audio");e.length>1&&o.src&&(submitButton.disabled=!1)}function startRecording(){blob=[],recordButton.disabled=!0,stopButton.disabled=!1,recorder.start(),setTimeout(function(){stopRecording()},5001)}function stopRecording(){recordButton.disabled=!1,stopButton.disabled=!0,recorder.stop()}function onRecordingReady(e){var o=document.getElementById("audio");document.getElementById("tag").value;blob.push(e.data),o.src=URL.createObjectURL(e.data),o.play()}function post(){var e=(document.getElementById("audio"),document.getElementById("tag").value),o=new FormData,t=Date.now().toString();o.append("filename",randomFile+"_"+random+"_"+t),o.append("plural",random),o.append("tag",e),o.append("folder",folder),o.append("fileId",randomFile),o.append(randomFile+"_"+random+"_"+t,blob[0]),0==posting&&(posting=!0,$.ajax({url:url.heroku+"dmai"+folder,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){posting=!1,alert("Survey code is: "+random5)}}))}var folder="laugh",question="Record a laugh.",recordButton=void 0,stopButton=void 0,recorder=void 0,submitButton=void 0,filename=void 0,word=void 0,blob=[],url={heroku:"https://dmaiaudio.herokuapp.com/api/",dev:"http://localhost:3300/api/"},options={mimeType:"audio/ogg"},random=Math.floor(2*Math.random()+1),randomFile=Math.floor(3*Math.random()+1),posting=!1,random5=Math.floor(9e4*Math.random())+1e4;1==randomFile?(word="Ball",filename="images/ball.png"):2==randomFile?(word="Bee",filename="images/bee.png"):(word="Can",filename="images/can.png");var isSecureOrigin="https:"===location.protocol||"localhost"===location.hostname;isSecureOrigin||(alert("getUserMedia() must be run from a secure origin: HTTPS or localhost.\n\nChanging protocol to HTTPS"),location.protocol="HTTPS"),document.getElementById("question").innerHTML=question,document.getElementById("image").src=filename,document.getElementById("secondImage").src=filename,document.getElementById("singular").innerHTML=word,document.getElementById("plural").innerHTML=word+"s",1==random&&(document.getElementById("secondImage").style.display="none"),window.onload=function(){recordButton=document.getElementById("record"),stopButton=document.getElementById("stop"),submitButton=document.getElementById("submit"),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){recordButton.disabled=!1,submitButton.disabled=!0,recordButton.addEventListener("click",startRecording),stopButton.addEventListener("click",stopRecording),MediaRecorder.isTypeSupported(options.mimeType)||(options={mimeType:"audio/ogg"},MediaRecorder.isTypeSupported(options.mimeType)||(options={mimeType:"audio/mpeg"},MediaRecorder.isTypeSupported(options.mimeType)||(options={mimeType:""})));try{recorder=new MediaRecorder(e,options)}catch(e){return void alert("Exception while creating MediaRecorder: "+e+". mimeType: "+options.mimeType)}recorder.addEventListener("dataavailable",onRecordingReady)})};